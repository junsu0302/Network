# 네트워크 기술

## 1. 교환 시스템

네트워크 양단에 연결된 호스트들이 전소앟는 패킷은 전송 경로 중간에 위치한 교환 시스템을 거친다. 교환 시스템은 데이터를 최종 목적지까지 올바른 경로로 중개하는 **교환**기능을 제공한다.

교환 기능은 다음과 같은 종류가 있다. 아래로 갈수록 구조가 복잡하고 전송 단위가 가변적이다.

```markdown
1. 회선 교환
2. 셀 릴레이
3. 프레임 릴레이
4. 패킷 교환
```

### 1.1 교환 시스템의 종류

전송 선로를 이용해 데이터를 전송할 때는 전용 회선 or 교환 회선을 이용할 수 있다.
```markdown
전용 회선 : 수신 호스트 전용으로 할당된 통신 선로
교환 회선 : 전송 선로 하나를 다수의 사용자가 공유
> 회선 교환
> 패킷 교환
> 메세지 교환
```

교환 회선을 이용하기 위해서는 중간에 위치한 교환 시스템의 중개가 필요하다. 교환 시스템은 특정 선로에 데이터가 집중되지 않으면서 효율적인 경로를 선택할 수 있도록 한다.

교환 회선은 논리적 연결 설정 유뮤에 따라 **회선 교환**과 **패킷 교환**, **메세지 교환**으로 나뉜다.

#### 1.1.1. 회선 교환
```markdown
통신하고자 하는 호스트가 데이터를 전송하기 전에 연결 경로를 미리 설정하는 방식
> 안정적 데이터 전송률
```

#### 1.1.2. 메세지 교환
```markdown
데이터를 전송하기 전에 전송하는 메세지의 헤더마다 목적지 주소를 표시하는 방식
> 전송된 전체 메세지가 도착할 때까지 받은 메세지는 버퍼에 저장
> 데이터 전송이 교환기 단위로 이루어짐
```

#### 1.1.3. 패킷 교환
```markdown
데이터를 패킷 단위로 나누어 전송
> 패킷은 독립적으로 라우팅 과정을 거쳐 도착

장점
1. 전송 대역의 효율적 이용
> 여러 호스트에서 전송한 패킷들이 동적인 방식으로 전송 대역 공유
2. 호스트의 무제한 수용
> 임의의 연결 요청에 고정 대역을 할당하지 않아 이론상 호스트 무제한 수용 가능
3. 패킷에 우선순위 부여 간단

단점
1. 전송 과정에서 회선 교환보다 많은 지연 발생
2. 전체 데이터 전송 시간 지연
> 전송 시간이 일정하지 않아 마지막 패킷으로 인해 발생
> 가변적인 전송 지연 분포를 지터라고한다.
```

### 1.2. 패킷 교환

네트워크 계층의 가장 중요한 역할은 패킷의 전송 경로를 결정하는 것이다. 패킷 교환 방식은 다음과 같은 방법으로 데이터를 전송한다.

```markdown
가상 회선 : 송수신 호스트 사이 가상 연결 설정으로 모든 패킷의 전달 경로 동일
데이터그램 : 독립적 패킷 경로 선텍
```

#### 1.2.1. 가상 회선

연결형 서비스를 지원하기 위한 기능으로 다음과 같이 동작한다.
```markdown
1. 송수신 사이 가상의 단일 파이프 설정
2. 송신 호스트가 입력단으로 패킷 송신
3. 수신 호스트가 출력단에서 패킷 수신

> 전송되는 모든 패킷의 경로 동일
> 패킷이 보낸 순서와 도착 순서 동일
```

#### 1.2.2. 데이터그램

비연결형 서비스를 지원하기 위한 기능으로 다음과 같이 동작한다.
```markdown
1. 송신 호스트가 패킷 단위 전송
2. 각 패킷 별 독립적 라우팅

> 가변적 전송 경로 속도
> 가변적 데이터 도착 순서
```

### 1.3. 프레임 릴레이와 셀 릴레이

패킷 교환 개발 당시 물리적 전송 오류로 인해 오버헤드 비트를 많이 추가했다. 이로 인해 송수신 시스템의 오류 처리 과정이 복잡해졌다. 하지만 현대 네트워크는 물리적 전송 오류가 발생할 가능성이 낮다. 따라서 여러 계층에서 수행되는 오류 제어 기능 중 중복되는 부분을 제거하면 패킷 전송 속도를 높일 수 있다. 이처럼 데이터 전송 속도 향상을 위해서는 **프레임 릴레이**와 **셀 릴레이** 방식이 사용된다.

#### 1.3.1. 프레임 릴레이

패킷 교환망은 데이터가 라우터를 거치는 과정에서 데이터 링크 계층의 기능이 수행된다. 이로인해 개별 링크에서 데이터 프레임과 긍정 응답 프레임을 교환한다. 하지만 신뢰도 높은 네트워크 환경에서는 시간 낭비가 될 수 있다.

```markdown
동일한 속도의 전송 매체로 고속 데이터를 지원

> 홉 단위 흐름 제어와 오류 제어 기능을 수행 X
> 한 호스트에서 수신한 프레임을 다른 호스트로 중개하는 역할만 진행
>> 홉 : 각 라우터의 개별 연결
```

#### 1.3.2. 셀 릴레이

```markdown
셀이라는 고정 크기 패킷 사용
> 고정적 크기로 인해 패킷 처리 과정에서 오버헤드를 줄임
```

## 2. LAN, MAN, WAN

컴퓨터 네트워크를 다양한 기준으로 분류할 수 있다. 그 중에서 호스트 사이의 연결 거리를 기준으로 네트워크를 LAN, MAN, WAN으로 구분할 수 있다. 연결 거리는 데이터의 전송 지연에 많은 영향을 미친다.

### 2.1. LAN

소규모 지역에 위치하는 호스트로 구성된 네트워크다. 호스트 간격이 가까워 **브로드캐스팅** 방식으로 전송한다. LAN 환경에서 호스트를 연결하는 방식을 구성 형태에 따라 **버스형**, **링형**으로 구분한다.

#### 2.1.1. 버스형
```markdown
브로드캐스팅 방식으로 한 호스트가 전송한 데이터를 네트워크에 연결된 모든 호스트에 전송한다. 
1. 전송 데이터에 송수신 호스트 주소 표기
2. 목적지에 해당하는 호스트만 내부 버퍼에 데이터 저장
3. 데이터 충돌 허용 후 사후 처리

> 라우터 기능 필요 X
```

#### 2.1.2. 링형
```markdown
브로드캐스팅 방식으로 순환 구조의 호스트 연결
1. 송신 호스트는 사전에 전송용 토큰 확보
> 충돌 방지
2. 토큰은 네트워크에 연결된 모든 호스트에 순환
3. 토큰은 하나만 존재
```

### 2.2. MAN

건물 or 도시에서 구성된 네트워크다. MAN은 DQDB라는 국제 표준안을 따른다. 이 규격은 다음과 같은 특징을 가진다.
```markdown
1. 전송 방향이 다른 두 버스로 모든 호스트 연결
2. 분사 데이터 큐 유지
3. 데이터 전송 시 발생 가능한 충돌문제 해결을 위한 공유 슬롯 방식 사용
4. ATM과 호환 가능하도록 53 바이트 프레임 지원
```

### 2.3. WAN

국가 이상에서 구성된 네트워크다. 1:1 방식으로 연결하여 네트워크를 확장한다. 그렇기 때문에 교환 기능이 반드시 필요하다.

## 3. 인터네트워킹

둘 이상의 서로 다른 네트워크를 연결하는 기능을 **인터네트워크**라고 한다. 인터네트워크를 지원하려면 연결되는 네트워크의 차이를 분석해 전송 데이터를 적절히 중개해야 한다. 네트워크 연결을 위한 장비는 수행 기능에 따라 다음과 같이 나뉜다.

`데이터 링크 계층 = LLC 계층 + MAC 계층`
*MAC 계층이 하위, LCC 계층이 상위*

- **리피터**
```markdown
1. 비트 신호를 중폿하여 전달
2. 물리 계층의 기능 수행
```

- **브리지**
```markdown
1. 한쪽 단의 MAC 헤더를 다른 단의 MAC 헤더로 변형
> 종류가 다른 LAN 연결 가능
> 주소가 같은 LAN이면 행동 X
2. 데이터 링크 계층 기능 수행
```

- **라우터**
```markdown
1. 수신한 패킷을 해석해 적절한 경로로 전송
2. 교환 기능을 통해 다수 LAN 연결
3. 네트워크 계층의 기능 수행
```

- **게이트웨이**
```markdown
1. 네트워크 장비의 상위 개념
2. 네트워크 양단의 특성이 다른 환경에서 중개 역할
```

### 3.1. 브리지

LAN과 LAN 사이에서 데이터를 중개할 때 각 LAN에서 사용하는 MAC 계층이 다를 경우 MAC 헤더를 적절하게 제거 및 추가해야한다.

브리지는 동작 방식에 따라 **트랜스페런트 브리지**와 **소스 라우팅 브리지**가 있다.

#### 3.1.1. 트랜스페런트 브리지

```markdown
1. 라우팅 기능을 사용자에게 투명하게 보여줌
2. 라우팅 과정은 브리지가 자동으로 수행
> 사용자는 전송하는 프레임의 주소부에 라우팅 정보를 추가하지 않아도 됨
3. 공유 버스 or 토큰 버스 방식에서 사용
> 사용자 입장에서 간편
```

트랜스페런트 브리지에 임의의 LAN으로부터 프레임이 도착했을 때, 브리지는 두 가지 동작 중 하나를 수행한다.
```markdown
1. 프레임 수신 호스트가 송신 호스트와 동일한 방향에 위치한 경우
> 무시
2. 프레임 수신 호스트가 송신 호스트와 다른 방향에 위치한 경우
> 프레임 중개
```

이러한 동작을 하기 위해서는 **라우팅 테이블**을 근거로 판단한다. 라우팅 테이블에는 각 호스트가 어느 포트에 연결되지가 저장된다. 

- **라우팅 테이블**

라우팅 테이블의 동작 과정은 다음과 같다.
```markdown
1. 브리지에 전원이 들어오면 라우팅테이블 생성
2. 플러딩 알고리즘을 통해 프레임 포트 위치 저장
```

- **플러딩 알고리즘**

동작 과정에서 브리지에 입력된 프레임 송신 호스트 주소를 근거로 송신 호스트가 몇 번 포트에 연결되었는지 확인하는 알고리즘이다. 이처럼 네트워크 동작 과정에서 라우팅 벙보를 얻는 방식을 **역방향 학습 알고리즘**이라고 한다. 

역방향 학습 알고리즘은 네트워크에 이중 경로가 존재하면 잘못된 라우팅 정보를 얻을 수 있다. 이중 경로가 존재하면 두 브리지는 데이터를 양쪽 포트로 전달하기 때뭉네 전송 프레임이 네트워크를 계속 순환하게 된다. 이러한 문제를 방지하기 위해 **스패닝 트리**라는 비순환 구조를 사용한다.

- **스패닝 트리**

스패닝 트리 알고리즘은 다음과 같이 구현된다.

```markdown
1. 브리지가 자신의 고유 번호를 공개
2. 번호가 가장 낮은 브리지를 트리 구조 최상위인 루트로 지정
3. 루트 브리지에서 다른 모든 브리지까지의 최단 경로 트리 구성
```

#### 3.1.2. 소스 라우팅 브리지

```markdown
1. 송신 프레임 내부에 수신 호스트까지 도달하기 위한 모든 경로 기술
2. 프레임을 수신한 브리지가 프레임을 적절한 경로로 전달
3. 링 구조 네트워크에서 사용
```

### 3.2. 인터넷 라우팅

라우터의 역할은 수신된 IP 데이터그램을 적절한 경로로 전달하는 것이다. 이를 위해 인터넷의 전체 구성과 현재 상태 정보를 활용해 경로를 선택해야 한다. 대표적인 라우팅 빙식으로는 **고정 경로 배졍**과 **적응 경로 배정**이 있다.

#### 3.2.1. 고정 경로 배정

```markdown
송수신 호스트 사이에 영구불변의 경로 배정
> 트래픽 변화에 따른 동적 경로 배정 불가
> 트래픽 측정을 통한 적절한 배정으로 간단한 라우팅 가능
```

#### 3.2.2. 적응 경로 배정

```markdown
인터넷 연결 상태가 변하면 이를 데이터그램의 전달 경로에 반영
> 경로 결정 복잡도에 따라 라우터 부담 증가
> 내트워크 내 모든 라우터에 동시 반영 불가능
> 불일치성 해결 과정에서 라우터 부담 및 트래픽 증가
```

#### 3.2.3. 자율 시스템

```markdown
다수의 라우터로 구성되어 공통의 라우팅 프로토콜 사용
> 내부 라우팅 프로토콜 : 시스템 내부 라우팅 정보 교환
> 외부 라우팅 프로토콜 : 자율 시스템 간 정보 교환
```

## 4. 서비스 품질(QoS)

네트워크에서 품질은 데이터를 신뢰성있게 전송하는지를 의미한다. 신뢰성은 다음의 조건들로 판단한다.

```markdown
1. 데이터 분실
2. 전송 지연
3. 지연 값의 일관성(지터)
```

### 4.1. QoS 개요

QoS는 네트워크 품질을 의미한다. QoS는 전송 계층 연결을 설정할 때 필요한 서비스 정도를 매개변수로 표현한다. 자주 언급되는 매개변수는 다음과 같다.

- **연결 설정 지연**
```markdown
request 프리미티브와 confirm 프리미티브 사이 경과 시간
```

- **연결 설정 실패 확률**
```markdown
임의의 최대 연결 설정 지연 시간을 기준으로 연결 설정이 이루어지지 않을 확률
```

- **전송률**
```markdown
임의의 시간 구간에서 초당 전송할 수 있는 바이트 수
```

- **전송 지연**
```markdown
송신 호스트가 전송한 데이터가 수신 호스트에 도착할 때까지 경과 시간
```

- **전송 오류율**
```markdown
임의의 구간에서 전송된 총 데이터 수와 오류 발생 데이터 수의 비율
```

- **우선순위** 
```markdown
다른 연결보다 먼저 처리
```
